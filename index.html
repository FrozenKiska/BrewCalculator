<!DOCTYPE html>

<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∫–æ—Ñ–µ</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        background: var(--tg-theme-bg-color, #f9f6f3);
        color: var(--tg-theme-text-color, #000);
        padding: 16px;
        padding-bottom: 80px;
    }

    .container {
        max-width: 500px;
        margin: 0 auto;
        background: var(--tg-theme-secondary-bg-color, #fff);
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    h1 {
        text-align: center;
        color: var(--tg-theme-text-color, #6b4f3f);
        margin-bottom: 20px;
        font-size: 24px;
    }

    .input-group {
        margin-bottom: 16px;
    }

    label {
        display: block;
        margin-bottom: 6px;
        font-weight: 600;
        font-size: 14px;
        color: var(--tg-theme-text-color, #333);
    }

    input, select {
        width: 100%;
        padding: 12px;
        border: 1px solid var(--tg-theme-hint-color, #ccc);
        border-radius: 8px;
        font-size: 16px;
        background: var(--tg-theme-bg-color, #fff);
        color: var(--tg-theme-text-color, #000);
        transition: border-color 0.3s;
    }

    input:focus, select:focus {
        outline: none;
        border-color: var(--tg-theme-button-color, #6b4f3f);
    }

    button {
        width: 100%;
        padding: 14px;
        background: var(--tg-theme-button-color, #6b4f3f);
        color: var(--tg-theme-button-text-color, #fff);
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 600;
        transition: opacity 0.3s;
        margin-top: 20px;
    }

    button:active {
        opacity: 0.8;
    }

    .results {
        margin-top: 20px;
        background: var(--tg-theme-bg-color, #f3ece7);
        padding: 16px;
        border-radius: 10px;
        display: none;
        animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .results.show {
        display: block;
    }

    .results h3 {
        margin-bottom: 12px;
        color: var(--tg-theme-text-color, #6b4f3f);
        font-size: 18px;
    }

    .results h4 {
        margin-top: 16px;
        margin-bottom: 8px;
        color: var(--tg-theme-text-color, #6b4f3f);
        font-size: 16px;
    }

    .results p {
        margin: 8px 0;
        line-height: 1.5;
        font-size: 15px;
    }

    .results strong {
        color: var(--tg-theme-link-color, #6b4f3f);
    }

    .hidden {
        display: none;
    }

    /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ */
    body.dark-theme {
        background: #1a1a1a;
    }

    body.dark-theme .container {
        background: #2a2a2a;
        box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    body.dark-theme input,
    body.dark-theme select {
        background: #1a1a1a;
        border-color: #444;
    }

    body.dark-theme .results {
        background: #1a1a1a;
    }
</style>
```

</head>
<body>
    <div class="container">
        <h1>‚òï –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∫–æ—Ñ–µ</h1>

```
    <div class="input-group">
        <label for="method">–ú–µ—Ç–æ–¥ –∑–∞–≤–∞—Ä–∏–≤–∞–Ω–∏—è:</label>
        <select id="method" onchange="toggleMethodFields()">
            <option value="v60">V60 (–ü—É—Ä–æ–≤–µ—Ä)</option>
            <option value="aeropress">Aeropress</option>
            <option value="coldbrew">Cold Brew</option>
        </select>
    </div>

    <div class="input-group" id="aeropress-style-group" style="display:none;">
        <label for="aeropressStyle">–°—Ç–∏–ª—å –∞—ç—Ä–æ–ø—Ä–µ—Å—Å–∞:</label>
        <select id="aeropressStyle">
            <option value="concentrate">–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç + —Ä–∞–∑–±–∞–≤–ª–µ–Ω–∏–µ</option>
            <option value="direct">–ü—Ä—è–º–æ–µ –∑–∞–≤–∞—Ä–∏–≤–∞–Ω–∏–µ</option>
        </select>
    </div>

    <div class="input-group" id="coldbrew-style-group" style="display:none;">
        <label for="coldbrewStyle">–°—Ç–∏–ª—å –∫–æ–ª–¥–±—Ä—é:</label>
        <select id="coldbrewStyle">
            <option value="classic">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π (–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç)</option>
            <option value="flash">–§–ª—ç—à –±—Ä—é (—Å –ª—å–¥–æ–º)</option>
        </select>
    </div>

    <div class="input-group" id="coldbrew-time-group" style="display:none;">
        <label for="coldbrewTime">–í—Ä–µ–º—è –∑–∞–≤–∞—Ä–∏–≤–∞–Ω–∏—è:</label>
        <select id="coldbrewTime">
            <option value="12">12 —á–∞—Å–æ–≤</option>
            <option value="16" selected>16 —á–∞—Å–æ–≤</option>
            <option value="24">24 —á–∞—Å–∞</option>
        </select>
    </div>

    <div class="input-group">
        <label for="grinder">–ö–æ—Ñ–µ–º–æ–ª–∫–∞:</label>
        <select id="grinder">
            <option value="timemore_c3">Timemore C3</option>
            <option value="comandante">Comandante (red clix)</option>
            <option value="1zpresso_jx">1Zpresso JX</option>
            <option value="1zpresso_je">1Zpresso JE</option>
        </select>
    </div>
    
    <div class="input-group">
        <label for="volume">–ñ–µ–ª–∞–µ–º—ã–π –æ–±—ä–µ–º –Ω–∞–ø–∏—Ç–∫–∞ (–º–ª):</label>
        <input type="number" id="volume" value="300" min="100" max="1000" step="10">
    </div>
    
  <div class="input-group">
  <label for="country">–°—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è:</label>
  <select id="country">
      <option value="ethiopia">üá™üáπ –≠—Ñ–∏–æ–ø–∏—è</option>
      <option value="kenya">üá∞üá™ –ö–µ–Ω–∏—è</option>
      <option value="brazil">üáßüá∑ –ë—Ä–∞–∑–∏–ª–∏—è</option>
      <option value="colombia">üá®üá¥ –ö–æ–ª—É–º–±–∏—è</option>
      <option value="panama">üáµüá¶ –ü–∞–Ω–∞–º–∞</option>
      <option value="guatemala">üá¨üáπ –ì–≤–∞—Ç–µ–º–∞–ª–∞</option>
      <option value="costarica">üá®üá∑ –ö–æ—Å—Ç–∞-–†–∏–∫–∞</option>
      <option value="elsalvador">üá∏üáª –≠–ª—å-–°–∞–ª—å–≤–∞–¥–æ—Ä</option>
      <option value="yemen">üáæüá™ –ô–µ–º–µ–Ω</option>
      <option value="indonesia">üáÆüá© –ò–Ω–¥–æ–Ω–µ–∑–∏—è</option>
      <option value="rwanda">üá∑üáº –†—É–∞–Ω–¥–∞</option>
      <option value="burundi">üáßüáÆ –ë—É—Ä—É–Ω–¥–∏</option>
      <option value="mexico">üá≤üáΩ –ú–µ–∫—Å–∏–∫–∞</option>
  </select>
</div>

    <div class="input-group">
        <label for="process">–ú–µ—Ç–æ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–∏:</label>
        <select id="process">
            <option value="washed">–ú—ã—Ç–∞—è</option>
            <option value="natural">–ù–∞—Ç—É—Ä–∞–ª—å–Ω–∞—è</option>
            <option value="honey">–•–∞–Ω–∏</option>
        </select>
    </div>

    <div class="input-group">
        <label for="days">–î–Ω–µ–π –ø–æ—Å–ª–µ –æ–±–∂–∞—Ä–∫–∏:</label>
        <input type="number" id="days" value="7" min="0" max="30">
    </div>

    <button onclick="calculate()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç</button>

    <div class="results" id="results"></div>
</div>
```

<script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
    let tg = window.Telegram.WebApp;
    
    tg.expand();
    tg.enableClosingConfirmation();
    
    if (tg.colorScheme === 'dark') {
        document.body.classList.add('dark-theme');
    }

    tg.MainButton.setText('–ó–∞–∫—Ä—ã—Ç—å');
    tg.MainButton.hide();
    tg.MainButton.onClick(function() {
        tg.close();
    });

    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–º–æ–ª–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–æ—Ñ–µ–º–æ–ª–æ–∫
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–º–æ–ª–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–æ—Ñ–µ–º–æ–ª–æ–∫
const grinderSettings = {
    timemore_c3: {
        v60: 17,
        aeropress: 14,
        coldbrew: Math.round(17 * 1.3)
    },
    comandante: {
        v60: 41,
        aeropress: 29,
        coldbrew: Math.round(41 * 1.3)
    },
    '1zpresso_jx': {
        v60: 73,
        aeropress: 54,
        coldbrew: Math.round(73 * 1.3)
    },
    '1zpresso_je': {
        v60: 82,
        aeropress: 73,
        coldbrew: Math.round(82 * 1.3)
    }
};

// üîΩ –≤–æ—Ç —Å—é–¥–∞ –≤—Å—Ç–∞–≤–ª—è–µ—à—å
const originAdjust = {
    ethiopia:   { temp:  1, grind: -0.5 },
    kenya:      { temp:  2, grind: -0.5 },
    brazil:     { temp: -1, grind:  1   },
    colombia:   { temp:  0, grind:  0   },
    panama:     { temp:  2, grind: -1   },
    guatemala:  { temp:  1, grind: -0.5 },
    costarica:  { temp:  1, grind:  0   },
    elsalvador: { temp:  0, grind:  0.5 },
    yemen:      { temp:  2, grind: -1   },
    indonesia:  { temp: -1, grind:  1   },
    rwanda:     { temp:  1, grind: -0.5 },
    burundi:    { temp:  1, grind: -0.5 },
    mexico:     { temp:  0, grind:  0.5 }
};

    function toggleMethodFields() {
        const method = document.getElementById('method').value;
        const aeropressStyleGroup = document.getElementById('aeropress-style-group');
        const coldbrewStyleGroup = document.getElementById('coldbrew-style-group');
        const coldbrewTimeGroup = document.getElementById('coldbrew-time-group');
        
        aeropressStyleGroup.style.display = 'none';
        coldbrewStyleGroup.style.display = 'none';
        coldbrewTimeGroup.style.display = 'none';
        
        if (method === 'aeropress') {
            aeropressStyleGroup.style.display = 'block';
        } else if (method === 'coldbrew') {
            coldbrewStyleGroup.style.display = 'block';
            coldbrewTimeGroup.style.display = 'block';
        }
    }

    function calculate() {
        if (tg.HapticFeedback) {
            tg.HapticFeedback.impactOccurred('light');
        }

        let method = document.getElementById('method').value;
        let aeropressStyle = document.getElementById('aeropressStyle').value;
        let coldbrewStyle = document.getElementById('coldbrewStyle').value;
        let coldbrewTime = document.getElementById('coldbrewTime').value;
        let grinder = document.getElementById('grinder').value;
        let volume = parseFloat(document.getElementById('volume').value);
        let country = document.getElementById('country').value;
        let process = document.getElementById('process').value;
        let days = parseInt(document.getElementById('days').value);

        let resultHTML = '';

        if (method === 'v60') {
            resultHTML = calculateV60(grinder, volume, country, process, days);
        } else if (method === 'aeropress') {
            resultHTML = calculateAeropress(grinder, volume, country, process, days, aeropressStyle);
        } else if (method === 'coldbrew') {
            resultHTML = calculateColdBrew(grinder, volume, country, process, days, coldbrewStyle, coldbrewTime);
        }

        let resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = resultHTML;
        resultsDiv.classList.add('show');

        tg.MainButton.show();

        if (tg.HapticFeedback) {
            tg.HapticFeedback.notificationOccurred('success');
        }
    }

    function calculateV60(grinder, volume, country, process, days) {
        let ratio = 16;
        let baseTemp = 93;
        let baseGrind = grinderSettings[grinder].v60;

        if (country === "ethiopia") {
            baseTemp += 1;
        } else if (country === "kenya") {
            baseTemp += 2;
        } else if (country === "brazil") {
            baseTemp -= 1;
            ratio = 15;
        }

        if (process === "natural") {
            baseTemp -= 1;
            baseGrind += 1;
        } else if (process === "honey") {
            baseTemp -= 0.5;
        }

        if (days <= 5) {
            baseGrind += 1;
            baseTemp += 1;
        } else if (days >= 15) {
            baseGrind -= 1;
            baseTemp -= 1;
        }

        let coffeeWeight = Math.round(volume / ratio * 10) / 10;
        let bloom = coffeeWeight * 2;
        let firstPour = volume * 0.40;
        let secondPour = volume * 0.70;
        let finalPour = volume;

        let grinderName = getGrinderName(grinder);

        return `
            <h3>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è V60</h3>
            <p>‚òï –ö–æ—Ñ–µ: <strong>${coffeeWeight} –≥</strong></p>
            <p>üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–æ–¥—ã: <strong>${baseTemp.toFixed(1)}¬∞C</strong></p>
            <p>‚öôÔ∏è –ü–æ–º–æ–ª (${grinderName}): <strong>${Math.round(baseGrind)} –∫–ª–∏–∫–æ–≤</strong></p>
            <p>‚è±Ô∏è –û–±—â–µ–µ –≤—Ä–µ–º—è: <strong>~3:00-3:30</strong></p>
            <br>
            <h4>üíß –≠—Ç–∞–ø—ã –∑–∞–ª–∏–≤–∫–∏ —Å —Ç–∞–π–º–∏–Ω–≥–æ–º:</h4>
            <p>1Ô∏è‚É£ <strong>0:00</strong> - –ë–ª—é–º–∏–Ω–≥: <strong>${Math.round(bloom)} –º–ª</strong>, –ø–æ–¥–æ–∂–¥–∞—Ç—å –¥–æ 0:30</p>
            <p>2Ô∏è‚É£ <strong>0:30</strong> - –ü–µ—Ä–≤—ã–π –∑–∞–ª–∏–≤ –¥–æ <strong>${Math.round(firstPour)} –º–ª</strong> (–∑–∞–∫–æ–Ω—á–∏—Ç—å –∫ ~1:15)</p>
            <p>3Ô∏è‚É£ <strong>1:15</strong> - –í—Ç–æ—Ä–æ–π –∑–∞–ª–∏–≤ –¥–æ <strong>${Math.round(secondPour)} –º–ª</strong> (–∑–∞–∫–æ–Ω—á–∏—Ç—å –∫ ~2:00)</p>
            <p>4Ô∏è‚É£ <strong>2:00</strong> - –§–∏–Ω–∞–ª—å–Ω—ã–π –∑–∞–ª–∏–≤ –¥–æ <strong>${Math.round(finalPour)} –º–ª</strong> (–∑–∞–∫–æ–Ω—á–∏—Ç—å –∫ ~2:30)</p>
            <p>5Ô∏è‚É£ <strong>~3:00-3:30</strong> - –í—Å—è –≤–æ–¥–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–π—Ç–∏</p>
        `;
    }

    function calculateAeropress(grinder, volume, country, process, days, style) {
        let baseTemp = 88;
        let baseGrind = grinderSettings[grinder].aeropress;

        if (country === "ethiopia") {
            baseTemp += 1;
        } else if (country === "kenya") {
            baseTemp += 2;
        } else if (country === "brazil") {
            baseTemp -= 1;
        }

        if (process === "natural") {
            baseTemp -= 1;
            baseGrind += 1;
        } else if (process === "honey") {
            baseTemp -= 0.5;
        }

        if (days <= 5) {
            baseGrind += 1;
            baseTemp += 1;
        } else if (days >= 15) {
            baseGrind -= 1;
            baseTemp -= 1;
        }

        let grinderName = getGrinderName(grinder);

        if (style === 'concentrate') {
            let coffeeWeight = 18;
            let brewWater = Math.round(coffeeWeight * 11);
            let bloom = coffeeWeight * 2.8;
            let secondPour = brewWater;
            let concentrate = Math.round(coffeeWeight * 4.2);
            let dilution = volume - concentrate;

            return `
                <h3>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è Aeropress</h3>
                <p><em>–°—Ç–∏–ª—å: –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç + —Ä–∞–∑–±–∞–≤–ª–µ–Ω–∏–µ</em></p>
                <p>‚òï –ö–æ—Ñ–µ: <strong>${coffeeWeight} –≥</strong></p>
                <p>üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–æ–¥—ã: <strong>${baseTemp.toFixed(1)}¬∞C</strong></p>
                <p>‚öôÔ∏è –ü–æ–º–æ–ª (${grinderName}): <strong>${Math.round(baseGrind)} –∫–ª–∏–∫–æ–≤</strong></p>
                <p>üîÑ –ü–æ–∑–∏—Ü–∏—è: <strong>Inverted (–ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–∞—è)</strong></p>
                <br>
                <h4>üíß –≠—Ç–∞–ø—ã –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è:</h4>
                <p>1Ô∏è‚É£ –ë–ª—é–º–∏–Ω–≥: <strong>${Math.round(bloom)} –º–ª</strong> –≤–æ–¥—ã (30 —Å–µ–∫)</p>
                <p>2Ô∏è‚É£ –î–æ–ª–∏–≤ –¥–æ: <strong>${Math.round(secondPour)} –º–ª</strong></p>
                <p>3Ô∏è‚É£ –í—Ä–µ–º—è —ç–∫—Å—Ç—Ä–∞–∫—Ü–∏–∏: <strong>1:30</strong> (–æ–±—â–µ–µ)</p>
                <p>4Ô∏è‚É£ –ü–µ—Ä–µ–≤–æ—Ä–æ—Ç –∏ –ø—Ä–µ—Å—Å–æ–≤–∞–Ω–∏–µ: <strong>30 —Å–µ–∫</strong></p>
                <p>5Ô∏è‚É£ –ü–æ–ª—É—á–∏—Ç—Å—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç: <strong>~${concentrate} –º–ª</strong></p>
                <p>6Ô∏è‚É£ –†–∞–∑–±–∞–≤–∏—Ç—å –≤–æ–¥–æ–π: <strong>+${Math.round(dilution)} –º–ª</strong> –¥–æ ${volume} –º–ª</p>
            `;
        } else {
            let ratio = 15;
            let coffeeWeight = Math.round(volume / ratio * 10) / 10;
            let bloom = coffeeWeight * 2.8;
            let totalWater = volume;

            return `
                <h3>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è Aeropress</h3>
                <p><em>–°—Ç–∏–ª—å: –ü—Ä—è–º–æ–µ –∑–∞–≤–∞—Ä–∏–≤–∞–Ω–∏–µ</em></p>
                <p>‚òï –ö–æ—Ñ–µ: <strong>${coffeeWeight} –≥</strong></p>
                <p>üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–æ–¥—ã: <strong>${baseTemp.toFixed(1)}¬∞C</strong></p>
                <p>‚öôÔ∏è –ü–æ–º–æ–ª (${grinderName}): <strong>${Math.round(baseGrind)} –∫–ª–∏–∫–æ–≤</strong></p>
                <p>üîÑ –ü–æ–∑–∏—Ü–∏—è: <strong>Inverted (–ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–∞—è)</strong></p>
                <br>
                <h4>üíß –≠—Ç–∞–ø—ã –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è:</h4>
                <p>1Ô∏è‚É£ –ë–ª—é–º–∏–Ω–≥: <strong>${Math.round(bloom)} –º–ª</strong> –≤–æ–¥—ã (30 —Å–µ–∫)</p>
                <p>2Ô∏è‚É£ –î–æ–ª–∏–≤ –¥–æ: <strong>${Math.round(totalWater)} –º–ª</strong></p>
                <p>3Ô∏è‚É£ –í—Ä–µ–º—è —ç–∫—Å—Ç—Ä–∞–∫—Ü–∏–∏: <strong>1:30</strong> (–æ–±—â–µ–µ)</p>
                <p>4Ô∏è‚É£ –ü–µ—Ä–µ–≤–æ—Ä–æ—Ç –∏ –ø—Ä–µ—Å—Å–æ–≤–∞–Ω–∏–µ: <strong>30-40 —Å–µ–∫</strong></p>
                <p>5Ô∏è‚É£ –ì–æ—Ç–æ–≤—ã–π –Ω–∞–ø–∏—Ç–æ–∫: <strong>${volume} –º–ª</strong></p>
            `;
        }
    }

    function calculateColdBrew(grinder, volume, country, process, days, style, brewTime) {
        let baseGrind = grinderSettings[grinder].coldbrew;
        let grinderName = getGrinderName(grinder);

        // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ–º–æ–ª–∞ –ø–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ (–¥–ª—è –∫–æ–ª–¥–±—Ä—é –º–µ–Ω—å—à–µ –≤–ª–∏—è–µ—Ç)
        if (process === "natural") {
            baseGrind += 1;
        }

        if (style === 'classic') {
            // –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç
            let ratio = 8; // 1:8 –¥–ª—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–∞
            let coffeeWeight = Math.round(volume / ratio * 10) / 10;
            let waterAmount = volume;
            let concentrate = volume;
            let suggestedDilution = Math.round(volume * 0.5); // —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–∞–∑–±–∞–≤–ª–µ–Ω–∏–µ 1:1

            return `
                <h3>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è Cold Brew</h3>
                <p><em>–°—Ç–∏–ª—å: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç</em></p>
                <p>‚òï –ö–æ—Ñ–µ: <strong>${coffeeWeight} –≥</strong></p>
                <p>üå°Ô∏è –í–æ–¥–∞: <strong>–ö–æ–º–Ω–∞—Ç–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (20-25¬∞C)</strong></p>
                <p>‚öôÔ∏è –ü–æ–º–æ–ª (${grinderName}): <strong>${Math.round(baseGrind)} –∫–ª–∏–∫–æ–≤</strong></p>
                <p>‚è∞ –í—Ä–µ–º—è –∑–∞–≤–∞—Ä–∏–≤–∞–Ω–∏—è: <strong>${brewTime} —á–∞—Å–æ–≤</strong></p>
                <br>
                <h4>üíß –ü—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ:</h4>
                <p>1Ô∏è‚É£ –°–º–µ—à–∞—Ç—å –∫–æ—Ñ–µ —Å <strong>${Math.round(waterAmount)} –º–ª</strong> –≤–æ–¥—ã</p>
                <p>2Ô∏è‚É£ –ü–æ—Å—Ç–∞–≤–∏—Ç—å –≤ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫ –Ω–∞ <strong>${brewTime} —á–∞—Å–æ–≤</strong></p>
                <p>3Ô∏è‚É£ –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ –±—É–º–∞–∂–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä</p>
                <p>4Ô∏è‚É£ –ü–æ–ª—É—á–∏—Ç—Å—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç: <strong>~${Math.round(concentrate * 0.85)} –º–ª</strong></p>
                <br>
                <h4>ü•§ –ü–æ–¥–∞—á–∞:</h4>
                <p>üí° –†–∞–∑–±–∞–≤–∏—Ç—å –≤–æ–¥–æ–π/–º–æ–ª–æ–∫–æ–º <strong>1:1</strong> (–¥–æ–±–∞–≤–∏—Ç—å ~${suggestedDilution} –º–ª)</p>
                <p>üßä –î–æ–±–∞–≤–∏—Ç—å –ª—ë–¥ –ø–æ –≤–∫—É—Å—É</p>
                <p>üì¶ –•—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –≤ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–µ –¥–æ 2 –Ω–µ–¥–µ–ª—å</p>
            `;
        } else {
            // –§–ª—ç—à –±—Ä—é (—è–ø–æ–Ω—Å–∫–∏–π –º–µ—Ç–æ–¥)
            let ratio = 15; // –∫–∞–∫ –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –∑–∞–≤–∞—Ä–∏–≤–∞–Ω–∏—è
            let totalVolume = volume;
            let iceWeight = Math.round(volume * 0.4); // 40% - –ª—ë–¥
            let hotWater = volume - iceWeight; // 60% - –≥–æ—Ä—è—á–∞—è –≤–æ–¥–∞
            let coffeeWeight = Math.round(hotWater / ratio * 10) / 10;
            
            // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –¥–ª—è —Ñ–ª—ç—à –±—Ä—é
            let baseTemp = 95; // –≤—ã—à–µ —á–µ–º –æ–±—ã—á–Ω–æ
            if (country === "ethiopia") {
                baseTemp += 1;
            } else if (country === "kenya") {
                baseTemp += 1;
            }

            let bloom = coffeeWeight * 2;

            return `
                <h3>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è Cold Brew</h3>
                <p><em>–°—Ç–∏–ª—å: –§–ª—ç—à –±—Ä—é (—è–ø–æ–Ω—Å–∫–∏–π –º–µ—Ç–æ–¥)</em></p>
                <p>‚òï –ö–æ—Ñ–µ: <strong>${coffeeWeight} –≥</strong></p>
                <p>üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–æ–¥—ã: <strong>${baseTemp}¬∞C</strong></p>
                <p>‚öôÔ∏è –ü–æ–º–æ–ª (${grinderName}): <strong>${Math.round(baseGrind)} –∫–ª–∏–∫–æ–≤</strong></p>
                <p>üßä –õ—ë–¥: <strong>${iceWeight} –≥</strong></p>
                <br>
                <h4>üíß –ü—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ:</h4>
                <p>1Ô∏è‚É£ –ü–æ–ª–æ–∂–∏—Ç—å <strong>${iceWeight} –≥ –ª—å–¥–∞</strong> –≤ —Å–µ—Ä–≤–µ—Ä</p>
                <p>2Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥—Ä–∏–ø–ø–µ—Ä —Å –∫–æ—Ñ–µ –Ω–∞–¥ —Å–µ—Ä–≤–µ—Ä–æ–º</p>
                <p>3Ô∏è‚É£ –ë–ª—é–º–∏–Ω–≥: <strong>${Math.round(bloom)} –º–ª</strong> –≤–æ–¥—ã (30 —Å–µ–∫)</p>
                <p>4Ô∏è‚É£ –ó–∞–ª–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—É—é –≤–æ–¥—É: <strong>${Math.round(hotWater)} –º–ª</strong> –≥–æ—Ä—è—á–µ–π –≤–æ–¥—ã</p>
                <p>5Ô∏è‚É£ –ö–æ—Ñ–µ —Å—Ä–∞–∑—É –æ—Ö–ª–∞–∂–¥–∞–µ—Ç—Å—è, –ø–∞–¥–∞—è –Ω–∞ –ª—ë–¥</p>
                <p>6Ô∏è‚É£ –ì–æ—Ç–æ–≤—ã–π –Ω–∞–ø–∏—Ç–æ–∫: <strong>${totalVolume} –º–ª</strong></p>
                <br>
                <h4>ü•§ –†–µ–∑—É–ª—å—Ç–∞—Ç:</h4>
                <p>‚ú® –Ø—Ä–∫–∏–π, –∞—Ä–æ–º–∞—Ç–Ω—ã–π —Ö–æ–ª–æ–¥–Ω—ã–π –∫–æ—Ñ–µ –∑–∞ 3-4 –º–∏–Ω—É—Ç—ã</p>
                <p>üßä –°—Ä–∞–∑—É –≥–æ—Ç–æ–≤ –∫ —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—é</p>
            `;
        }
    }

    function getGrinderName(grinder) {
        const names = {
            'timemore_c3': 'Timemore C3',
            'comandante': 'Comandante',
            '1zpresso_jx': '1Zpresso JX',
            '1zpresso_je': '1Zpresso JE'
        };
        return names[grinder] || grinder;
    }

    window.onload = function() {
        calculate();
    };

    tg.onEvent('themeChanged', function() {
        if (tg.colorScheme === 'dark') {
            document.body.classList.add('dark-theme');
        } else {
            document.body.classList.remove('dark-theme');
        }
    });
</script>

</body>
</html>